window.Exercises={Models:{},Collections:{},Views:{},Routers:{},init:function(){"use strict";new Exercises.Routers.Blog;Backbone.history.start()}},$(document).ready(function(){"use strict";console.info("Starting Course Evaluation SPA ... "),Exercises.init()}),function(){Exercises.helpers={debug:function(a){a.on("all",function(){$("#output").text(JSON.stringify(a.toJSON(),null,4))}),a.trigger("reset")},showErrors:function(a,b){$(".has-error").removeClass("has-error"),$(".alert").html(_.values(b).join("<br>")).show(),_.each(_.keys(b),function(a){$("*[name="+a+"]").parent().addClass("has-error")})}}}(),this.JST=this.JST||{},this.JST["app/scripts/templates/blog-form.ejs"]=function(obj){obj||(obj={});var __t,__p="";_.escape,Array.prototype.join;with(obj)__p+='<div class="row">\n  <div class="col-md-6 col-md-offset-3">\n    <div class="alert alert-danger fade in" style="display:none;"></div>\n    <form>\n      <h2>'+(null==(__t=name)?"":__t)+"</h2>\n      ","undefined"!=typeof id&&(__p+='\n      <div class="form-group">\n        <label>ID:</label>\n        <input type="text" class="form-control" name="id" value="'+(null==(__t=id)?"":__t)+'" readonly />\n      </div>\n      '),__p+='\n      <div class="form-group">\n        <label>Title:</label>\n        <input type="text" class="form-control" name="title" value="'+(null==(__t=title)?"":__t)+'" />\n      </div>\n      <div class="form-group">\n        <label>Description:</label>\n        <input type="text" class="form-control" name="description" value="'+(null==(__t=description)?"":__t)+'" />\n      </div>\n      <div class="form-group">\n        <label>Done:</label>\n        <input type="checkbox" class="form-control" name="done" '+(null==(__t=done?"checked":"")?"":__t)+' />\n      </div>\n      <button class="save btn btn-large btn-info" type="submit">Save</button>\n      <a href="#blog/index" class="btn btn-large btn-default">Cancel</a>\n    </form>\n  </div>\n</div>\n';return __p},this.JST["app/scripts/templates/blog-index.ejs"]=function(obj){obj||(obj={});var __t,__p="";_.escape,Array.prototype.join;with(obj)__p+='<a style="margin:10px 0px;"\n   class="btn btn-large btn-primary"\n   href="#blog/new">\n  <i class="fa fa-plus"></i>\n  New Course\n</a>\n<!--<a data-toggle="collapse"-->\n   <!--data-target="#collapseExample2"-->\n   <!--aria-expanded="false"-->\n   <!--aria-controls="collapseExample2"-->\n   <!--style="margin:10px 0px;"-->\n   <!--class="btn btn-large btn-success"-->\n   <!--href="#blog/index">-->\n  <!--<i class="fa fa-list"></i>-->\n  <!--View Data (Double Click)-->\n<!--</a>-->\n\n<div">\n  ',_.isEmpty(blogs)&&(__p+='\n  <div class="alert alert-warning">\n    <p>There are currently no courses. Try creating some.</p>\n  </div>\n  '),__p+='\n\n  <table class="table table-bordered table-striped">\n    <thead>\n    <tr>\n      <th>ID</th>\n      <th>Title</th>\n      <th>Description</th>\n      <th>Done</th>\n      <th width="140">Action</th>\n    </tr>\n    </thead>\n    <tbody>\n    ',_.each(blogs,function(a){__p+="\n    <tr>\n      <td>"+(null==(__t=a.id)?"":__t)+"</td>\n      <td>"+(null==(__t=a.title)?"":__t)+"</td>\n      <td>"+(null==(__t=a.description)?"":__t)+"</td>\n      <td>"+(null==(__t=a.done)?"":__t)+'</td>\n      <td class="text-center">\n        <a class="btn btn-xs btn-info" href="#blog/'+(null==(__t=a.id)?"":__t)+'/edit"><i class="fa fa-pencil"></i> Edit</a>\n        <a class="btn btn-xs btn-danger" href="#blog/'+(null==(__t=a.id)?"":__t)+'/delete"><i class="fa fa-trash"></i> Delete</a>\n      </td>\n    </tr>\n    '}),__p+="\n    </tbody>\n  </table>\n</div>\n\n";return __p},this.JST["app/scripts/templates/usage.ejs"]=function(obj){obj||(obj={});var __t,__p="";_.escape;with(obj)__p+="<p>Total Visited: "+(null==(__t=count)?"":__t)+"</p>\n\n";return __p},Exercises.Models=Exercises.Models||{},function(){"use strict";Exercises.Models.Blog=Backbone.Model.extend({initialize:function(){},defaults:{title:"",description:"",done:!1},validate:function(a,b){}})}(),Exercises.Collections=Exercises.Collections||{},function(){"use strict";Exercises.Collections.Blog=Backbone.Collection.extend({model:Exercises.Models.Blog,url:"http://localhost:5000/ce/api/v1.0/courses",parse:function(a){return a.courses}})}(),Exercises.Views=Exercises.Views||{},function(){"use strict";Exercises.Views.Blog=Backbone.View.extend({template:JST["app/scripts/templates/blog-index.ejs"],el:$("#main"),initialize:function(){this.listenTo(this.collection,"change",this.render),this.listenTo(this.collection,"sync",this.render)},render:function(){return console.log("Rending BlogIndex ..."),this.$el.html(this.template({blogs:this.collection.toJSON()})),this}}),Exercises.Views.BlogAdd=Backbone.View.extend({events:{"click button.save":"save","keyup input":"validate","keyup textarea":"validate"},template:JST["app/scripts/templates/blog-form.ejs"],initialize:function(a){this.model.bind("invalid",Exercises.helpers.showErrors,Exercises.helpers)},save:function(a){a.stopPropagation(),a.preventDefault(),this.model.set({title:this.$("input[name=title]").val(),description:this.$("input[name=description]").val(),done:this.$("input[name=done]").is(":checked")}),this.model.isValid()&&(this.collection.add(this.model),this.model.save(),Backbone.history.navigate("blog/index",{trigger:!0}))},render:function(){return this.$el.html(this.template(this.model.toJSON())),this}}),Exercises.Views.BlogEdit=Backbone.View.extend({events:{"click button.save":"save"},template:JST["app/scripts/templates/blog-form.ejs"],initialize:function(a){this.model.bind("invalid",Exercises.helpers.showErrors,Exercises.helpers),this.model.bind("invalid",this.invalid,this)},invalid:function(){this.$el.find("a.cancel").hide()},save:function(a){a.stopPropagation(),a.preventDefault(),this.model.set({title:this.$("input[name=title]").val(),description:this.$("input[name=description]").val(),done:this.$("input[name=done]").is(":checked")}),this.model.isValid()&&(this.model.save(),Backbone.history.navigate("blog/index",{trigger:!0}))},render:function(){return this.$el.html(this.template(this.model.toJSON())),this}})}(),Exercises.Models=Exercises.Models||{},function(){"use strict";Exercises.Models.Usage=Backbone.Model.extend({urlRoot:"http://localhost:5000/ce/api/v1.0/usages",initialize:function(){},defaults:{}})}(),Exercises.Views=Exercises.Views||{},function(){"use strict";Exercises.Views.Usage=Backbone.View.extend({template:JST["app/scripts/templates/usage.ejs"],tagName:"div",id:"",className:"",events:{},initialize:function(){var a=this.model;this.listenTo(this.model,"change",this.render),$(document).on("click",'[data-target="#myApiUsage"]',function(b){a.fetch({ajaxSync:!0,success:function(){console.info("Fetched usages for showing in a modal window")}})})},render:function(){return this.$el.html(this.template(this.model.toJSON())),this}})}(),Exercises.Routers=Exercises.Routers||{},function(){"use strict";Exercises.Routers.Blog=Backbone.Router.extend({routes:{"blog/new":"create","blog/index":"index","blog/:id/edit":"edit","blog/:id/delete":"delete",usages:"showUsages"},$container:$("#main"),$usagesContainer:$("#usages"),initialize:function(){this.collection=new Exercises.Collections.Blog,this.blogIndexView=new Exercises.Views.Blog({collection:this.collection}),console.log("Fetching courses ..."),this.collection.fetch({ajaxSync:!0,success:function(){console.log("Courses has been fetched successfully.")}}),Exercises.helpers.debug(this.collection),this.usages=new Exercises.Models.Usage,this.usagesView=new Exercises.Views.Usage({model:this.usages,el:this.$usagesContainer}),console.log("Fetching usages ..."),this.usages.fetch({ajaxSync:!0,success:function(){console.log("Usage has been fetched successfully.")}})},create:function(){var a=new Exercises.Views.BlogAdd({collection:this.collection,model:new Exercises.Models.Blog});this.$container.html(a.render().el)},"delete":function(a){var b=this.collection.get(a);b.destroy(),this.index()},edit:function(a){var b=new Exercises.Views.BlogEdit({model:this.collection.get(a)});this.$container.html(b.render().el)},index:function(){this.blogIndexView.render()},showUsages:function(){this.$usagesContainer.html(this.usagesView.render().el)}})}();